<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>BBU Layout</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }
    .bbu-frame {
      display: grid;
      grid-template-columns: 1fr 2fr 2fr 1fr;
      grid-template-rows: repeat(4, 1fr);
      gap: 5px;
      width: 800px;
      height: 200px; /* chiều rộng gấp 4 lần chiều cao */
      border: 3px solid #333;
      padding: 10px;
      box-sizing: border-box;
    }
    .slot {
      border: 1px solid #666;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 12px;
      text-align: center;
      padding: 2px;
      background: #f9f9f9;
    }
    .slot.empty {
      background: #eee;
      color: #aaa;
    }
    /* Slot 14 và 15 cao 1.5 lần slot 1 */
    .slot14 { grid-row: span 2; }
    .slot15 { grid-row: span 2; }
    /* Slot 16 cao gấp 4 lần slot 1 */
    .slot16 { grid-row: span 4; }
  </style>
</head>
<body>
  <div class="bbu-frame" id="bbu"></div>

  <script>
    async function loadExcel() {
      const response = await fetch('inventory.xlsx');
      const arrayBuffer = await response.arrayBuffer();
      const workbook = XLSX.read(arrayBuffer, { type: 'array' });
      const sheetName = workbook.SheetNames[0];
      const sheet = workbook.Sheets[sheetName];
      return XLSX.utils.sheet_to_json(sheet);
    }

    function parsePosition(pos) {
      const match = pos.match(/Slot=(\d+)/);
      return match ? parseInt(match[1]) : null;
    }

    function renderBBU(data) {
      const bbu = document.getElementById('bbu');
      bbu.innerHTML = '';

      const layout = [
        [13, 14, 15],
        [1, 2, 3, 4],
        [5, 6, 7, 8],
        [16]
      ];

      const slotMap = {};
      data.forEach(item => {
        const slot = parsePosition(item['Unit Position'] || '');
        if (slot) slotMap[slot] = item;
      });

      layout.forEach((col, colIndex) => {
        col.forEach(slot => {
          const item = slotMap[slot];
          const div = document.createElement('div');
          div.classList.add('slot');
          if (slot === 14) div.classList.add('slot14');
          if (slot === 15) div.classList.add('slot15');
          if (slot === 16) div.classList.add('slot16');

          if (item) {
            div.innerHTML = `Rack=1 Slot=${slot}<br>${item['Vendor Unit Type Name'] || ''}<br>SN: ${item['Serial Number'] || ''}`;
          } else {
            div.classList.add('empty');
            div.innerHTML = `Slot ${slot}: empty`;
          }
          bbu.appendChild(div);
        });
      });
    }

    (async () => {
      const data = await loadExcel();
      renderBBU(data);
    })();
  </script>
</body>
</html>
